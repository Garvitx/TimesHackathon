# SnapNews

**SnapNews** is an AI-powered news summarizer web application. It allows authenticated Editors to submit URLs or raw text of news articles and receive concise, HTML-formatted summaries generated by OpenAI. Admins can manage Editor accounts and view usage analytics.

---

## ğŸ“¦ Tech Stack

* **Backend:** Node.js, Express.js
* **Database & ORM:** Prisma ORM with PostgreSQL (production) or SQLite (development)
* **Cache & Queue:** Redis, BullMQ (for optional background processing)
* **AI Service:** OpenAI Chat Completion API
* **Authentication:** JWT for user auth, HMAC-signed tokens for summarization endpoint
* **Email:** Nodemailer (SMTP) for password resets
* **Frontend:** React (React Router, Context or Redux)
* **Utilities:** Axios (HTTP), node-html-parser (HTML parsing)

---

## ğŸš€ Getting Started

### Prerequisites

* Node.js v18 or higher
* Redis server (local or remote)
* PostgreSQL server (or SQLite for local dev)

### Installation

1. **Clone the repository**

   ```bash
   git clone https://github.com/Garvitx/TimesHackathon.git
   cd TimesHackathon/src/backend
   ```
2. **Install dependencies**

   ```bash
   npm install
   ```
3. **Configure environment variables**
   Create a `.env` file in `src/backend` with the following keys:

   ```dotenv
   # Server
   PORT=4000

   # Database
   DATABASE_URL="postgresql://user:pass@localhost:5432/snapnews"  # or "file:./dev.db" for SQLite

   # Redis
   REDIS_URL=redis://localhost:6379

   # OpenAI
   OPENAI_API_KEY=sk-...

   # JWT
   JWT_SECRET=your_jwt_secret
   JWT_RESET_SECRET=your_reset_secret

   # Summarization Token (HMAC)
   ACCESS_TOKEN_SECRET=your_hmac_secret
   ACCESS_TOKEN_TTL_MS=300000    # e.g., 5 minutes

   # Rate limiting
   SUMMARIZE_RATE_WINDOW_MS=3600000  # 1 hour
   SUMMARIZE_RATE_MAX=100

   # CORS & Frontend
   FRONTEND_URL=http://localhost:3000

   # SMTP (password reset)
   SMTP_HOST=smtp.mailprovider.com
   SMTP_PORT=587
   SMTP_USER=youremail@example.com
   SMTP_PASS=emailpassword
   ```
4. **Initialize the database**

   ```bash
   npx prisma migrate dev --name init
   ```
5. **Seed an Admin user** (optional)

   ```bash
   npm run seed
   ```

   > Default seeded admin: `admin@gmail.com` / `Admin123`. Change immediately in production.

### Running the App

* **Development mode** (with auto-reload via nodemon):

  ```bash
  npm run dev
  ```
* **Production mode**:

  ```bash
  npm start
  ```

The API will be accessible at `https://stingray-app-j7k4v.ondigitalocean.app/` by default.

---

## ğŸ“š API Endpoints

| Method | Path                        | Auth                    | Description                                   |
| ------ | --------------------------- | ----------------------- | --------------------------------------------- |
| GET    | `/api/key`                  | Public (rate-limited)   | Issue HMAC-signed token for summarization     |
| POST   | `/api/auth/login`           | Public                  | User login (returns JWT)                      |
| POST   | `/api/auth/signup`          | Admin only              | Create an Editor account                      |
| POST   | `/api/auth/forgot-password` | Public                  | Send password reset email                     |
| POST   | `/api/auth/reset-password`  | Public                  | Reset password via JWT link                   |
| POST   | `/api/summarize`            | HMAC token + rate limit | Generate or retrieve a cached article summary |
| GET    | `/api/editor/summaries`     | Editor or Admin (JWT)   | List all summaries                            |
| GET    | `/api/editor/summaries/:id` | Editor or Admin (JWT)   | Retrieve a summary by ID                      |
| PUT    | `/api/editor/summaries/:id` | Editor or Admin (JWT)   | Update summary title or status                |
| GET    | `/api/admin/dashboard`      | Admin only (JWT)        | Fetch usage analytics                         |
| GET    | `/health`                   | Public                  | Health check (DB & Redis connectivity)        |

---

## ğŸ“ Backend Structure

```
src/backend/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ routes/
â”‚   â””â”€â”€ middleware/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ default.js
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma
â”‚   â””â”€â”€ migrations/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.js
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ cache.js
â”‚   â”‚   â””â”€â”€ queue.js
â”‚   â””â”€â”€ workers/
â”‚       â””â”€â”€ summaryWorker.js
â”œâ”€â”€ .env.example
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---       